var X=Object.defineProperty;var Z=(n,a,t)=>a in n?X(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t;var u=(n,a,t)=>Z(n,typeof a!="symbol"?a+"":a,t);import{S as C,r as S,q as M,j as e,f as T}from"./app-fsDHji84.js";import{T as ee,a as se,b as m,c}from"./tabs-BRJPYHw0.js";import{C as x,a as j,B as p}from"./select-RKrPQWSw.js";import{u as ae,A as te}from"./AdminLayout-o01hw8_n.js";import{u as re,M as le,y as ne}from"./MessageComposer-D6wClMMS.js";import{u as ie,R as ce}from"./RecipientSelector-C5DX4Swf.js";import oe from"./AnalyticsDashboard-P6YfV0_b.js";import{I as f}from"./InputLabel-DIB2tpb0.js";import{I as g}from"./input-CowZnUHa.js";import de from"./Configuration-C8L4cAmb.js";import{P as D}from"./PrimaryButton-D_Dwyf_j.js";import{P as B}from"./PrintErrors-iLojis5S.js";import"./index-Ce96heDo.js";import"./index.es-BxVbqNES.js";import"./moment-DD0DDCTd.js";import"./react-Bj2dw0a7.js";import"./InputError-CFWIaf5r.js";import"./DangerButton-qSeUa7Rw.js";import"./transition-B_O15Do_.js";var me="https://sms.capcom.me/api/3rdparty/v1";class pe{constructor(a,t,r,v=me){u(this,"baseUrl");u(this,"httpClient");u(this,"defaultHeaders");this.baseUrl=v,this.httpClient=r,this.defaultHeaders={"User-Agent":"android-sms-gateway/1.0 (client; js)",Authorization:`Basic ${btoa(`${a}:${t}`)}`}}async send(a){const t=`${this.baseUrl}/message`,r={"Content-Type":"application/json",...this.defaultHeaders};return this.httpClient.post(t,a,r)}async getState(a){const t=`${this.baseUrl}/message/${a}`,r={...this.defaultHeaders};return this.httpClient.get(t,r)}async getWebhooks(){const a=`${this.baseUrl}/webhooks`,t={...this.defaultHeaders};return this.httpClient.get(a,t)}async registerWebhook(a){const t=`${this.baseUrl}/webhooks`,r={"Content-Type":"application/json",...this.defaultHeaders};return this.httpClient.post(t,a,r)}async deleteWebhook(a){const t=`${this.baseUrl}/webhooks/${a}`,r={...this.defaultHeaders};return this.httpClient.delete(t,r)}}var he=pe;const Fe=({tabActive:n="compose",templates:a,allrecipients:t,allsegments:r=[],config:v,cloudconfig:F,messages:E})=>{const{activeTab:$,setActiveTab:o}=ae(),{recipients:l}=ie(),{message:N,template_:R}=re(),{setData:P}=C({recipients:l,message:""});S.useEffect(()=>{P("message",N),P("recipients",l),l&&console.log("recipients:",l)},[l,N]);const{flash:d}=M().props;S.useEffect(()=>{d&&window.alert_toast(d.title,d.message,d.icon)},[d]);const[H,k]=S.useState(!1),I=async()=>{try{k(!0);const s=await axios.post("/services/send-sms",{message:N,phoneNumbers:l.map(i=>i.phone),recipients:l});if(s.data.flash){const{icon:i,message:h,title:A}=s.data.flash;alert_toast(A,h,i)}console.log(s)}catch(s){console.error("Error:",s),ne.error("Failed to send message")}finally{k(!1),T.reload({only:["messages"]})}},U={get:async(s,i)=>(await fetch(s,{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("mjgwapo:ocWFMPKc")}})).json(),post:async(s,i,h)=>(await fetch(s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("mjgwapo:ocWFMPKc")},body:JSON.stringify(i)})).json(),delete:async(s,i)=>(await fetch(s,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Basic "+btoa("mjgwapo:ocWFMPKc")}})).json()};new he("mjgwapo","ocWFMPKc",U);const{user:w}=M().props.auth,{data:b,setData:y,errors:L,processing:W,put:_,clearErrors:z,reset:K}=C({current_password:"",password:"",confirmpw:""}),O=s=>{s.preventDefault(),_(route("admin.settings.password.update"),{onSuccess:()=>{z(),K()},onFinish:()=>{T.reload({only:["flash","auth"]})}})},{data:q,setData:G,errors:J,processing:Q,put:V}=C({email:w==null?void 0:w.email}),Y=s=>{s.preventDefault(),V(route("admin.settings.email.update"),{onFinish:()=>{T.reload({only:["flash","auth"]})}})};return e.jsxs(te,{children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Text Blaster"}),e.jsx(x,{className:"mb-6",children:e.jsx(j,{className:"p-6",children:e.jsxs(ee,{value:$,onValueChange:o,className:"w-full",children:[e.jsxs(se,{className:"grid grid-cols-5 mb-6",children:[e.jsx(m,{value:"compose",children:"Compose"}),e.jsx(m,{value:"recipients",children:"Recipients"}),e.jsx(m,{value:"schedule",children:"Schedule"}),e.jsx(m,{value:"analytics",children:"Analytics"}),e.jsx(m,{value:"configuration",children:"Configuration"})]}),e.jsx(c,{value:"compose",className:"space-y-4",children:e.jsx(le,{onNext:()=>o("recipients"),messagetemps:a})}),e.jsx(c,{value:"recipients",className:"space-y-4",children:e.jsx(ce,{onBack:()=>o("compose"),onNext:()=>o("schedule"),allrecipients:t,allsegments:r})}),e.jsx(c,{value:"schedule",className:"space-y-4",children:e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Schedule Your Message"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"send-now",name:"schedule",defaultChecked:!0}),e.jsx("label",{htmlFor:"send-now",children:"Send Immediately"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"schedule-later",name:"schedule",disabled:!0}),e.jsxs("label",{htmlFor:"schedule-later",children:["Schedule for Later",e.jsx("small",{className:" text-black-50",children:" (On Development...)"})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date and Time"}),e.jsx("input",{type:"datetime-local",className:"w-full p-2 border rounded-md",disabled:!0})]})]}),e.jsxs("div",{className:"bg-muted/50 p-4 rounded-md",children:[e.jsx("h3",{className:"font-medium mb-2",children:"Message Summary"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Template:"})," ",R]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Recipients:"})," ",l.length," contacts"]})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[e.jsx(p,{variant:"outline",onClick:()=>o("recipients"),children:"Back"}),e.jsx(p,{onClick:()=>{I()},disabled:H,children:"Send Message"})]})]})}),e.jsx(c,{value:"analytics",className:"space-y-4",children:e.jsx(oe,{messages:E})}),e.jsx(c,{value:"configuration",className:"space-y-4",children:e.jsx(de,{config:v,cloudconfig:F})}),e.jsxs(c,{value:"accsettings",className:"space-y-4 w-1/2",children:[e.jsx(B,{errors:J}),e.jsx("h3",{children:"Change your email here"}),e.jsxs("div",{children:[e.jsx(f,{value:"Email"}),e.jsx(g,{value:q.email,className:" w-full",onChange:s=>G("email",s.target.value)})]}),e.jsx(D,{disabled:Q,onClick:Y,children:"Save New Email"}),e.jsxs("div",{children:[e.jsx(B,{errors:L}),e.jsxs("div",{className:" grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(f,{value:"Current Password"}),e.jsx(g,{value:b.current_password,className:" w-full",type:"password",onChange:s=>y("current_password",s.target.value)})]}),e.jsxs("div",{children:[e.jsx(f,{value:"New Password"}),e.jsx(g,{value:b.password,className:" w-full",type:"password",onChange:s=>y("password",s.target.value)})]})]}),e.jsxs("div",{children:[e.jsx(f,{value:"Confirm Password"}),e.jsx(g,{value:b.confirmpw,className:" w-full",type:"password",onChange:s=>y("confirmpw",s.target.value)})]})]}),e.jsx(D,{disabled:W,onClick:O,children:"Save new password"})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(x,{children:e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Recent Campaigns"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Summer Sale Promo"}),e.jsx("span",{className:"text-green-500 text-sm",children:"Sent"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Service Reminder"}),e.jsx("span",{className:"text-amber-500 text-sm",children:"Scheduled"})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"New Inventory Alert"}),e.jsx("span",{className:"text-gray-500 text-sm",children:"Draft"})]})]})]})}),e.jsx(x,{children:e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Message Stats"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Messages Sent (MTD)"}),e.jsx("span",{className:"font-medium",children:E.length})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Active Campaigns"}),e.jsx("span",{className:"font-medium",children:"0"})]})]})]})}),e.jsx(x,{children:e.jsxs(j,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{variant:"outline",className:"w-full justify-start",children:[e.jsx("span",{className:"mr-2",children:"+"})," New Template"]}),e.jsxs(p,{variant:"outline",className:"w-full justify-start",children:[e.jsx("span",{className:"mr-2",children:"+"})," Import Contacts"]}),e.jsxs(p,{variant:"outline",className:"w-full justify-start",children:[e.jsx("span",{className:"mr-2",children:"â†“"})," Export Reports"]})]})]})})]})]})};export{Fe as default};
